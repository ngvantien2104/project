
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<title>Quick Start - Leaflet</title>
	
	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

	<style>
		html, body {
			height: 100%;
			margin: 0;
		}
		.leaflet-container {
			height: 400px;
			width: 600px;
			max-width: 100%;
			max-height: 100%;
		}
	</style>

	
</head>
<body>



<div id="map" style="width: 100%; height: 100%;"></div>
<script src='https://unpkg.com/@turf/turf@6/turf.min.js'></script>
<script>


	var map = L.map('map').setView([16.075136, 108.163878], 13);

	var tiles = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
		maxZoom: 19,
		attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
	}).addTo(map);



    var geojson = {
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
          107.83920783243184,
          16.09992965136574
        ],
        "type": "Point"
      }
    },
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
          108.64273579881996,
          16.168984158990312
        ],
        "type": "Point"
      }
    },
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
          108.22573680949989,
          16.494519989539597
        ],
        "type": "Point"
      }
    },
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
          108.83362117810441,
          15.876331029903056
        ],
        "type": "Point"
      }
    },
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              107.79064833810622,
              16.31463427337041
            ],
            [
              107.75044584765901,
              16.312735002651134
            ],
            [
              107.71063283057877,
              16.30705559142938
            ],
            [
              107.67159491865458,
              16.297651060924306
            ],
            [
              107.63371010120295,
              16.28461250980164
            ],
            [
              107.59734500498924,
              16.268066215854162
            ],
            [
              107.5628512940076,
              16.248172391718384
            ],
            [
              107.53056222656161,
              16.225123607770684
            ],
            [
              107.50078940500865,
              16.199142898792477
            ],
            [
              107.47381975102543,
              16.17048157421851
            ],
            [
              107.44991273636914,
              16.139416754748154
            ],
            [
              107.42929789591284,
              16.10624866077294
            ],
            [
              107.41217264628547,
              16.07129768042959
            ],
            [
              107.39870042981306,
              16.034901247106184
            ],
            [
              107.38900919970071,
              15.997410557896734
            ],
            [
              107.38319025857578,
              15.959187165808824
            ],
            [
              107.38129745869007,
              15.920599479478451
            ],
            [
              107.38334676829854,
              15.882019204738897
            ],
            [
              107.38931620504476,
              15.843817762633758
            ],
            [
              107.39914613362112,
              15.806362718369146
            ],
            [
              107.41273992156752,
              15.770014255280554
            ],
            [
              107.42996494385078,
              15.735121727161616
            ],
            [
              107.45065392384228,
              15.70202032128308
            ],
            [
              107.47460659550075,
              15.671027863138654
            ],
            [
              107.50159166897375,
              15.642441792410356
            ],
            [
              107.53134907946226,
              15.616536337868062
            ],
            [
              107.56359249704867,
              15.593559916927184
            ],
            [
              107.59801207326767,
              15.573732783403702
            ],
            [
              107.6342773985014,
              15.557244944648026
            ],
            [
              107.6720406428031,
              15.544254366727552
            ],
            [
              107.71093985149079,
              15.534885483682942
            ],
            [
              107.75060236580708,
              15.529228024124842
            ],
            [
              107.79064833810622,
              15.527336165586641
            ],
            [
              107.83069431040536,
              15.529228024124842
            ],
            [
              107.87035682472165,
              15.534885483682942
            ],
            [
              107.90925603340935,
              15.544254366727552
            ],
            [
              107.94701927771105,
              15.557244944648026
            ],
            [
              107.98328460294479,
              15.573732783403702
            ],
            [
              108.01770417916377,
              15.593559916927184
            ],
            [
              108.04994759675019,
              15.616536337868062
            ],
            [
              108.0797050072387,
              15.642441792410356
            ],
            [
              108.1066900807117,
              15.671027863138654
            ],
            [
              108.13064275237016,
              15.70202032128308
            ],
            [
              108.15133173236167,
              15.735121727161616
            ],
            [
              108.16855675464494,
              15.770014255280554
            ],
            [
              108.18215054259133,
              15.806362718369146
            ],
            [
              108.19198047116768,
              15.843817762633758
            ],
            [
              108.19794990791391,
              15.882019204738897
            ],
            [
              108.19999921752238,
              15.920599479478451
            ],
            [
              108.19810641763667,
              15.959187165808824
            ],
            [
              108.19228747651175,
              15.997410557896734
            ],
            [
              108.18259624639938,
              16.034901247106184
            ],
            [
              108.16912402992699,
              16.07129768042959
            ],
            [
              108.1519987802996,
              16.10624866077294
            ],
            [
              108.1313839398433,
              16.139416754748154
            ],
            [
              108.10747692518702,
              16.17048157421851
            ],
            [
              108.0805072712038,
              16.199142898792477
            ],
            [
              108.05073444965085,
              16.225123607770684
            ],
            [
              108.01844538220485,
              16.248172391718384
            ],
            [
              107.98395167122322,
              16.268066215854162
            ],
            [
              107.9475865750095,
              16.28461250980164
            ],
            [
              107.90970175755788,
              16.297651060924306
            ],
            [
              107.87066384563367,
              16.30705559142938
            ],
            [
              107.83085082855344,
              16.312735002651134
            ],
            [
              107.79064833810622,
              16.31463427337041
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
          [
            [
              107.7535577905162,
              16.555281648845224
            ],
            [
              108.49311942072842,
              16.555281648845224
            ],
            [
              108.49311942072842,
              16.722889274821824
            ],
            [
              107.7535577905162,
              16.722889274821824
            ],
            [
              107.7535577905162,
              16.555281648845224
            ]
          ]
        ],
        "type": "Polygon"
      }
    },
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
          [
            [
              109.03608665006345,
              16.390957310083394
            ],
            [
              109.38567914443081,
              16.390957310083394
            ],
            [
              109.38567914443081,
              16.535562863863845
            ],
            [
              109.03608665006345,
              16.535562863863845
            ],
            [
              109.03608665006345,
              16.390957310083394
            ]
          ]
        ],
        "type": "Polygon"
      }
    },
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
          [
            [
              109.30848020217667,
              16.12803544825549
            ],
            [
              109.62070743205692,
              15.829915727456921
            ],
            [
              108.9805243850717,
              16.306425722259334
            ],
            [
              108.99178778568756,
              15.711612539721571
            ],
            [
              109.30845048465522,
              15.530875878384904
            ],
            [
              109.56619660306256,
              15.852908798267293
            ],
            [
              109.74398412775633,
              15.882483959108853
            ],
            [
              109.40048651202733,
              16.174952802487667
            ],
            [
              109.2095015830688,
              16.270252143547836
            ],
            [
              109.30848020217667,
              16.12803544825549
            ]
          ]
        ],
        "type": "Polygon"
      }
    }
  ]
};
var blackIcon = L.icon({
    iconUrl: 'iconblack.svg',
    iconSize: [20, 20],
    iconAnchor: [10, 20],
    popupAnchor: [-1, -50],

});
var redIcon = L.icon({
    iconUrl: 'iconred.svg',
    iconSize: [20, 20],
    iconAnchor: [10, 20],
    popupAnchor: [-1, -50],

});

    var markers = [];
    var coordinates = [ 
    [16.12803544825549,109.30848020217667],
    [17.12803544825549,109.30848020217667],
    [18.12803544825549,108.30848020217667]
    ];
    coordinates.forEach(function(coords){
        var marker=L.marker(coords,{
            icon: blackIcon
        }).on('mousemove',function(e){
            console.log(e);
            e.target.setIcon(redIcon);
        }).on('mouseout',function(e){
            console.log(e);
            e.target.setIcon(blackIcon);
        });
        markers.push(marker);
    });
  

    	
    var popup=L.popup();


	function onMapClick(e) {
    
		popup
			.setLatLng(e.latlng)
			.setContent('chỉ số bụi trung bình tại đây là ' + e.latlng.lat.toString() +","+ e.latlng.lng.toString())
			.openOn(map);
	}

	map.on('click', onMapClick);

  var options = {units: 'kilometers'};

  map.on('mousemove',function(e){
    console.log(e);
    var from = turf.point([e.latlng.lat, e.latlng.lng]);
    markers.forEach(function(marker){

      var to = turf.point([marker.getLatLng().lat,marker.getLatLng().lng]);
      var distance = turf.distance(from, to, options);
      if(distance<50){
        marker.setIcon(redIcon);
      }
      else{
        marker.setIcon(blackIcon);
      }
    });
    
  
  })
    var featureGroup = L.featureGroup(markers).addTo(map);

//     var addGeoJSON = L.geoJSON(geojson, {
//         style: function(feature) {
//             return {
//                 color: '#000',
//                 weight: 0.5
//             }
//         },
//         // setup icon trong geojson
//         pointToLayer: function(geojsonPoint, latlng){
//             return L.marker(latlng,{icon: myIcon});
            
//         },
//         // bật popup hiển thị  location bằng cách truy suất tới dữ liệu trong file geojson
//         onEachFeature: function(feature, layer){
//             if(feature.geometry.type==='Point'){
//                 layer.bindPopup(feature.geometry.coordinates.join(","))
//             }
//         }
//     }).addTo(map);


    map.fitBounds(featureGroup.getBounds(), {
        padding: [20,20]
    });
</script>



</body>
</html>
